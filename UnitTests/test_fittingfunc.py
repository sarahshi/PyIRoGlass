import os
import glob
import shutil
import unittest
import numpy as np
import pandas as pd
import PyIRoGlass as pig


class test_fitting_functions(unittest.TestCase):
    def setUp(self):
        self.file = "AC4_OL53_101220_256s_30x30_a"
        self.wn = [1000.916, 1002.845, 1004.774, 1006.702, 1008.631, 1010.559, 1012.488, 1014.416, 1016.345, 1018.273, 1020.202, 1022.13, 1024.059, 1025.988, 1027.916, 1029.845, 1031.773, 1033.702, 1035.63, 1037.559, 1039.487, 1041.416, 1043.344, 1045.273, 1047.202, 1049.13, 1051.059, 1052.987, 1054.916, 1056.844, 1058.773, 1060.701, 1062.63, 1064.558, 1066.487, 1068.416, 1070.344, 1072.273, 1074.201, 1076.13, 1078.058, 1079.987, 1081.915, 1083.844, 1085.773, 1087.701, 1089.63, 1091.558, 1093.487, 1095.415, 1097.344, 1099.272, 1101.201, 1103.129, 1105.058, 1106.987, 1108.915, 1110.844, 1112.772, 1114.701, 1116.629, 1118.558, 1120.486, 1122.415, 1124.344, 1126.272, 1128.201, 1130.129, 1132.058, 1133.986, 1135.915, 1137.843, 1139.772, 1141.7, 1143.629, 1145.557, 1147.486, 1149.415, 1151.343, 1153.272, 1155.2, 1157.129, 1159.057, 1160.986, 1162.914, 1164.843, 1166.771, 1168.7, 1170.629, 1172.557, 1174.486, 1176.414, 1178.343, 1180.271, 1182.2, 1184.128, 1186.057, 1187.986, 1189.914, 1191.843, 1193.771, 1195.7, 1197.628, 1199.557, 1201.485, 1203.414, 1205.343, 1207.271, 1209.2, 1211.128, 1213.057, 1214.985, 1216.914, 1218.842, 1220.771, 1222.699, 1224.628, 1226.557, 1228.485, 1230.414, 1232.342, 1234.271, 1236.199, 1238.128, 1240.056, 1241.985, 1243.913, 1245.842, 1247.771, 1249.699, 1251.628, 1253.556, 1255.485, 1257.413, 1259.342, 1261.27, 1263.199, 1265.127, 1267.056, 1268.985, 1270.913, 1272.842, 1274.77, 1276.699, 1278.627, 1280.556, 1282.484, 1284.413, 1286.342, 1288.27, 1290.199, 1292.127, 1294.056, 1295.984, 1297.913, 1299.841, 1301.77, 1303.698, 1305.627, 1307.556, 1309.484, 1311.413, 1313.341, 1315.27, 1317.198, 1319.127, 1321.055, 1322.984, 1324.912, 1326.841, 1328.77, 1330.698, 1332.627, 1334.555, 1336.484, 1338.412, 1340.341, 1342.269, 1344.198, 1346.126, 1348.055, 1349.984, 1351.912, 1353.841, 1355.769, 1357.698, 1359.626, 1361.555, 1363.483, 1365.412, 1367.341, 1369.269, 1371.198, 1373.126, 1375.055, 1376.983, 1378.912, 1380.84, 1382.769, 1384.698, 1386.626, 1388.555, 1390.483, 1392.412, 1394.34, 1396.269, 1398.197, 1400.126, 1402.054, 1403.983, 1405.911, 1407.84, 1409.769, 1411.697, 1413.626, 1415.554, 1417.483, 1419.411, 1421.34, 1423.268, 1425.197, 1427.125, 1429.054, 1430.983, 1432.911, 1434.84, 1436.768, 1438.697, 1440.625, 1442.554, 1444.482, 1446.411, 1448.34, 1450.268, 1452.197, 1454.125, 1456.054, 1457.982, 1459.911, 1461.839, 1463.768, 1465.697, 1467.625, 1469.554, 1471.482, 1473.411, 1475.339, 1477.268, 1479.196, 1481.125, 1483.053, 1484.982, 1486.911, 1488.839, 1490.768, 1492.696, 1494.625, 1496.553, 1498.482, 1500.41, 1502.339, 1504.267, 1506.196, 1508.125, 1510.053, 1511.982, 1513.91, 1515.839, 1517.767, 1519.696, 1521.624, 1523.553, 1525.481, 1527.41, 1529.339, 1531.267, 1533.196, 1535.124, 1537.053, 1538.981, 1540.91, 1542.838, 1544.767, 1546.696, 1548.624, 1550.553, 1552.481, 1554.41, 1556.338, 1558.267, 1560.195, 1562.124, 1564.052, 1565.981, 1567.91, 1569.838, 1571.767, 1573.695, 1575.624, 1577.552, 1579.481, 1581.409, 1583.338, 1585.266, 1587.195, 1589.124, 1591.052, 1592.981, 1594.909, 1596.838, 1598.766, 1600.695, 1602.623, 1604.552, 1606.48, 1608.409, 1610.338, 1612.266, 1614.195, 1616.123, 1618.052, 1619.98, 1621.909, 1623.837, 1625.766, 1627.695, 1629.623, 1631.552, 1633.48, 1635.409, 1637.337, 1639.266, 1641.194, 1643.123, 1645.052, 1646.98, 1648.909, 1650.837, 1652.766, 1654.694, 1656.623, 1658.551, 1660.48, 1662.408, 1664.337, 1666.266, 1668.194, 1670.123, 1672.051, 1673.98, 1675.908, 1677.837, 1679.765, 1681.694, 1683.622, 1685.551, 1687.479, 1689.408, 1691.337, 1693.265, 1695.194, 1697.122, 1699.051, 1700.979, 1702.908, 1704.836, 1706.765, 1708.694, 1710.622, 1712.551, 1714.479, 1716.408, 1718.336, 1720.265, 1722.193, 1724.122, 1726.051, 1727.979, 1729.908, 1731.836, 1733.765, 1735.693, 1737.622, 1739.55, 1741.479, 1743.407, 1745.336, 1747.265, 1749.193, 1751.122, 1753.05, 1754.979, 1756.907, 1758.836, 1760.764, 1762.693, 1764.621, 1766.55, 1768.479, 1770.407, 1772.336, 1774.264, 1776.193, 1778.121, 1780.05, 1781.978, 1783.907, 1785.835, 1787.764, 1789.693, 1791.621, 1793.55, 1795.478, 1797.407, 1799.335, 1801.264, 1803.192, 1805.121, 1807.049, 1808.978, 1810.907, 1812.835, 1814.764, 1816.692, 1818.621, 1820.549, 1822.478, 1824.406, 1826.335, 1828.264, 1830.192, 1832.121, 1834.049, 1835.978, 1837.906, 1839.835, 1841.763, 1843.692, 1845.62, 1847.549, 1849.478, 1851.406, 1853.335, 1855.263, 1857.192, 1859.12, 1861.049, 1862.977, 1864.906, 1866.834, 1868.763, 1870.692, 1872.62, 1874.549, 1876.477, 1878.406, 1880.334, 1882.263, 1884.191, 1886.12, 1888.048, 1889.977, 1891.906, 1893.834, 1895.763, 1897.691, 1899.62, 1901.548, 1903.477, 1905.405, 1907.334, 1909.263, 1911.191, 1913.12, 1915.048, 1916.977, 1918.905, 1920.834, 1922.762, 1924.691, 1926.62, 1928.548, 1930.477, 1932.405, 1934.334, 1936.262, 1938.191, 1940.119, 1942.048, 1943.976, 1945.905, 1947.833, 1949.762, 1951.691, 1953.619, 1955.548, 1957.476, 1959.405, 1961.333, 1963.262, 1965.19, 1967.119, 1969.047, 1970.976, 1972.905, 1974.833, 1976.762, 1978.69, 1980.619, 1982.547, 1984.476, 1986.404, 1988.333, 1990.262, 1992.19, 1994.119, 1996.047, 1997.976, 1999.904, 2001.833, 2003.761, 2005.69, 2007.619, 2009.547, 2011.476, 2013.404, 2015.333, 2017.261, 2019.19, 2021.118, 2023.047, 2024.975, 2026.904, 2028.833, 2030.761, 2032.69, 2034.618, 2036.547, 2038.475, 2040.404, 2042.332, 2044.261, 2046.189, 2048.118, 2050.046, 2051.975, 2053.904, 2055.832, 2057.761, 2059.689, 2061.618, 2063.546, 2065.475, 2067.403, 2069.332, 2071.26, 2073.189, 2075.118, 2077.046, 2078.975, 2080.903, 2082.832, 2084.76, 2086.689, 2088.617, 2090.546, 2092.475, 2094.403, 2096.332, 2098.26, 2100.189, 2102.117, 2104.046, 2105.974, 2107.903, 2109.832, 2111.76, 2113.688, 2115.617, 2117.546, 2119.474, 2121.403, 2123.331, 2125.26, 2127.188, 2129.117, 2131.045, 2132.974, 2134.903, 2136.831, 2138.76, 2140.688, 2142.617, 2144.545, 2146.474, 2148.402, 2150.331, 2152.26, 2154.188, 2156.117, 2158.045, 2159.974, 2161.902, 2163.831, 2165.759, 2167.688, 2169.616, 2171.545, 2173.474, 2175.402, 2177.331, 2179.259, 2181.188, 2183.116, 2185.045, 2186.973, 2188.902, 2190.831, 2192.759, 2194.688, 2196.616, 2198.545, 2200.473, 2202.402, 2204.33, 2206.259, 2208.188, 2210.116, 2212.044, 2213.973, 2215.902, 2217.83, 2219.759, 2221.687, 2223.616, 2225.544, 2227.473, 2229.401, 2231.33, 2233.259, 2235.187, 2237.116, 2239.044, 2240.973, 2242.901, 2244.83, 2246.758, 2248.687, 2250.615, 2252.544, 2254.473, 2256.401, 2258.33, 2260.258, 2262.187, 2264.115, 2266.044, 2267.972, 2269.901, 2271.83, 2273.758, 2275.687, 2277.615, 2279.544, 2281.472, 2283.401, 2285.329, 2287.258, 2289.187, 2291.115, 2293.043, 2294.972, 2296.901, 2298.829, 2300.758, 2302.686, 2304.615, 2306.543, 2308.472, 2310.4, 2312.329, 2314.258, 2316.186, 2318.115, 2320.043, 2321.972, 2323.9, 2325.829, 2327.757, 2329.686, 2331.615, 2333.543, 2335.472, 2337.4, 2339.329, 2341.257, 2343.186, 2345.114, 2347.043, 2348.971, 2350.9, 2352.829, 2354.757, 2356.686, 2358.614, 2360.543, 2362.471, 2364.4, 2366.328, 2368.257, 2370.186, 2372.114, 2374.042, 2375.971, 2377.9, 2379.828, 2381.757, 2383.685, 2385.614, 2387.542, 2389.471, 2391.399, 2393.328, 2395.257, 2397.185, 2399.114, 2401.042, 2402.971, 2404.899, 2406.828, 2408.756, 2410.685, 2412.614, 2414.542, 2416.471, 2418.399, 2420.328, 2422.256, 2424.185, 2426.113, 2428.042, 2429.97, 2431.899, 2433.828, 2435.756, 2437.685, 2439.613, 2441.542, 2443.47, 2445.399, 2447.327, 2449.256, 2451.185, 2453.113, 2455.042, 2456.97, 2458.899, 2460.827, 2462.756, 2464.684, 2466.613, 2468.542, 2470.47, 2472.398, 2474.327, 2476.256, 2478.184, 2480.113, 2482.041, 2483.97, 2485.898, 2487.827, 2489.755, 2491.684, 2493.613, 2495.541, 2497.47, 2499.398, 2501.327, 2503.255, 2505.184, 2507.112, 2509.041, 2510.969, 2512.898, 2514.827, 2516.755, 2518.684, 2520.612, 2522.541, 2524.469, 2526.398, 2528.326, 2530.255, 2532.184, 2534.112, 2536.041, 2537.969, 2539.898, 2541.826, 2543.755, 2545.683, 2547.612, 2549.541, 2551.469, 2553.397, 2555.326, 2557.255, 2559.183, 2561.112, 2563.04, 2564.969, 2566.897, 2568.826, 2570.754, 2572.683, 2574.612, 2576.54, 2578.469, 2580.397, 2582.326, 2584.254, 2586.183, 2588.111, 2590.04, 2591.969, 2593.897, 2595.826, 2597.754, 2599.683, 2601.611, 2603.54, 2605.468, 2607.397, 2609.325, 2611.254, 2613.183, 2615.111, 2617.04, 2618.968, 2620.897, 2622.825, 2624.754, 2626.682, 2628.611, 2630.54, 2632.468, 2634.396, 2636.325, 2638.254, 2640.182, 2642.111, 2644.039, 2645.968, 2647.896, 2649.825, 2651.753, 2653.682, 2655.611, 2657.539, 2659.468, 2661.396, 2663.325, 2665.253, 2667.182, 2669.11, 2671.039, 2672.968, 2674.896, 2676.825, 2678.753, 2680.682, 2682.61, 2684.539, 2686.467, 2688.396, 2690.324, 2692.253, 2694.182, 2696.11, 2698.039, 2699.967, 2701.896, 2703.824, 2705.753, 2707.681, 2709.61, 2711.539, 2713.467, 2715.396, 2717.324, 2719.253, 2721.181, 2723.11, 2725.038, 2726.967, 2728.896, 2730.824, 2732.752, 2734.681, 2736.61, 2738.538, 2740.467, 2742.395, 2744.324, 2746.252, 2748.181, 2750.109, 2752.038, 2753.967, 2755.895, 2757.824, 2759.752, 2761.681, 2763.609, 2765.538, 2767.466, 2769.395, 2771.323, 2773.252, 2775.181, 2777.109, 2779.038, 2780.966, 2782.895, 2784.823, 2786.752, 2788.68, 2790.609, 2792.538, 2794.466, 2796.395, 2798.323, 2800.252, 2802.18, 2804.109, 2806.037, 2807.966, 2809.895, 2811.823, 2813.751, 2815.68, 2817.609, 2819.537, 2821.466, 2823.394, 2825.323, 2827.251, 2829.18, 2831.108, 2833.037, 2834.966, 2836.894, 2838.823, 2840.751, 2842.68, 2844.608, 2846.537, 2848.465, 2850.394, 2852.323, 2854.251, 2856.18, 2858.108, 2860.037, 2861.965, 2863.894, 2865.822, 2867.751, 2869.679, 2871.608, 2873.537, 2875.465, 2877.394, 2879.322, 2881.251, 2883.179, 2885.108, 2887.036, 2888.965, 2890.894, 2892.822, 2894.75, 2896.679, 2898.608, 2900.536, 2902.465, 2904.393, 2906.322, 2908.25, 2910.179, 2912.107, 2914.036, 2915.965, 2917.893, 2919.822, 2921.75, 2923.679, 2925.607, 2927.536, 2929.464, 2931.393, 2933.322, 2935.25, 2937.179, 2939.107, 2941.036, 2942.964, 2944.893, 2946.821, 2948.75, 2950.678, 2952.607, 2954.536, 2956.464, 2958.393, 2960.321, 2962.25, 2964.178, 2966.107, 2968.035, 2969.964, 2971.893, 2973.821, 2975.75, 2977.678, 2979.607, 2981.535, 2983.464, 2985.392, 2987.321, 2989.25, 2991.178, 2993.106, 2995.035, 2996.964, 2998.892, 3000.821, 3002.749, 3004.678, 3006.606, 3008.535, 3010.463, 3012.392, 3014.321, 3016.249, 3018.178, 3020.106, 3022.035, 3023.963, 3025.892, 3027.82, 3029.749, 3031.677, 3033.606, 3035.535, 3037.463, 3039.392, 3041.32, 3043.249, 3045.177, 3047.106, 3049.034, 3050.963, 3052.892, 3054.82, 3056.749, 3058.677, 3060.606, 3062.534, 3064.463, 3066.391, 3068.32, 3070.249, 3072.177, 3074.105, 3076.034, 3077.963, 3079.891, 3081.82, 3083.748, 3085.677, 3087.605, 3089.534, 3091.462, 3093.391, 3095.32, 3097.248, 3099.177, 3101.105, 3103.034, 3104.962, 3106.891, 3108.819, 3110.748, 3112.677, 3114.605, 3116.534, 3118.462, 3120.391, 3122.319, 3124.248, 3126.176, 3128.105, 3130.033, 3131.962, 3133.891, 3135.819, 3137.748, 3139.676, 3141.605, 3143.533, 3145.462, 3147.39, 3149.319, 3151.248, 3153.176, 3155.104, 3157.033, 3158.962, 3160.89, 3162.819, 3164.747, 3166.676, 3168.604, 3170.533, 3172.461, 3174.39, 3176.319, 3178.247, 3180.176, 3182.104, 3184.033, 3185.961, 3187.89, 3189.818, 3191.747, 3193.676, 3195.604, 3197.532, 3199.461, 3201.39, 3203.318, 3205.247, 3207.175, 3209.104, 3211.032, 3212.961, 3214.889, 3216.818, 3218.747, 3220.675, 3222.604, 3224.532, 3226.461, 3228.389, 3230.318, 3232.246, 3234.175, 3236.104, 3238.032, 3239.961, 3241.889, 3243.818, 3245.746, 3247.675, 3249.603, 3251.532, 3253.46, 3255.389, 3257.318, 3259.246, 3261.175, 3263.103, 3265.032, 3266.96, 3268.889, 3270.817, 3272.746, 3274.675, 3276.603, 3278.531, 3280.46, 3282.389, 3284.317, 3286.246, 3288.174, 3290.103, 3292.031, 3293.96, 3295.888, 3297.817, 3299.746, 3301.674, 3303.603, 3305.531, 3307.46, 3309.388, 3311.317, 3313.245, 3315.174, 3317.103, 3319.031, 3320.96, 3322.888, 3324.817, 3326.745, 3328.674, 3330.602, 3332.531, 3334.459, 3336.388, 3338.317, 3340.245, 3342.174, 3344.102, 3346.031, 3347.959, 3349.888, 3351.816, 3353.745, 3355.674, 3357.602, 3359.531, 3361.459, 3363.388, 3365.316, 3367.245, 3369.173, 3371.102, 3373.031, 3374.959, 3376.887, 3378.816, 3380.745, 3382.673, 3384.602, 3386.53, 3388.459, 3390.387, 3392.316, 3394.244, 3396.173, 3398.102, 3400.03, 3401.959, 3403.887, 3405.816, 3407.744, 3409.673, 3411.601, 3413.53, 3415.458, 3417.387, 3419.316, 3421.244, 3423.173, 3425.101, 3427.03, 3428.958, 3430.887, 3432.815, 3434.744, 3436.673, 3438.601, 3440.53, 3442.458, 3444.387, 3446.315, 3448.244, 3450.172, 3452.101, 3454.03, 3455.958, 3457.886, 3459.815, 3461.744, 3463.672, 3465.601, 3467.529, 3469.458, 3471.386, 3473.315, 3475.243, 3477.172, 3479.101, 3481.029, 3482.958, 3484.886, 3486.815, 3488.743, 3490.672, 3492.6, 3494.529, 3496.458, 3498.386, 3500.315, 3502.243, 3504.172, 3506.1, 3508.029, 3509.957, 3511.886, 3513.814, 3515.743, 3517.672, 3519.6, 3521.529, 3523.457, 3525.386, 3527.314, 3529.243, 3531.171, 3533.1, 3535.029, 3536.957, 3538.885, 3540.814, 3542.743, 3544.671, 3546.6, 3548.528, 3550.457, 3552.385, 3554.314, 3556.242, 3558.171, 3560.1, 3562.028, 3563.957, 3565.885, 3567.814, 3569.742, 3571.671, 3573.599, 3575.528, 3577.457, 3579.385, 3581.314, 3583.242, 3585.171, 3587.099, 3589.028, 3590.956, 3592.885, 3594.813, 3596.742, 3598.671, 3600.599, 3602.528, 3604.456, 3606.385, 3608.313, 3610.242, 3612.17, 3614.099, 3616.028, 3617.956, 3619.885, 3621.813, 3623.742, 3625.67, 3627.599, 3629.527, 3631.456, 3633.385, 3635.313, 3637.241, 3639.17, 3641.099, 3643.027, 3644.956, 3646.884, 3648.813, 3650.741, 3652.67, 3654.598, 3656.527, 3658.456, 3660.384, 3662.313, 3664.241, 3666.17, 3668.098, 3670.027, 3671.955, 3673.884, 3675.813, 3677.741, 3679.67, 3681.598, 3683.527, 3685.455, 3687.384, 3689.312, 3691.241, 3693.169, 3695.098, 3697.027, 3698.955, 3700.884, 3702.812, 3704.741, 3706.669, 3708.598, 3710.526, 3712.455, 3714.384, 3716.312, 3718.24, 3720.169, 3722.098, 3724.026, 3725.955, 3727.883, 3729.812, 3731.74, 3733.669, 3735.597, 3737.526, 3739.455, 3741.383, 3743.312, 3745.24, 3747.169, 3749.097, 3751.026, 3752.954, 3754.883, 3756.812, 3758.74, 3760.669, 3762.597, 3764.526, 3766.454, 3768.383, 3770.311, 3772.24, 3774.168, 3776.097, 3778.026, 3779.954, 3781.883, 3783.811, 3785.74, 3787.668, 3789.597, 3791.525, 3793.454, 3795.383, 3797.311, 3799.24, 3801.168, 3803.097, 3805.025, 3806.954, 3808.882, 3810.811, 3812.74, 3814.668, 3816.596, 3818.525, 3820.454, 3822.382, 3824.311, 3826.239, 3828.168, 3830.096, 3832.025, 3833.953, 3835.882, 3837.811, 3839.739, 3841.668, 3843.596, 3845.525, 3847.453, 3849.382, 3851.31, 3853.239, 3855.167, 3857.096, 3859.025, 3860.953, 3862.882, 3864.81, 3866.739, 3868.667, 3870.596, 3872.524, 3874.453, 3876.382, 3878.31, 3880.239, 3882.167, 3884.096, 3886.024, 3887.953, 3889.881, 3891.81, 3893.739, 3895.667, 3897.595, 3899.524, 3901.453, 3903.381, 3905.31, 3907.238, 3909.167, 3911.095, 3913.024, 3914.952, 3916.881, 3918.81, 3920.738, 3922.667, 3924.595, 3926.524, 3928.452, 3930.381, 3932.309, 3934.238, 3936.167, 3938.095, 3940.024, 3941.952, 3943.881, 3945.809, 3947.738, 3949.666, 3951.595, 3953.523, 3955.452, 3957.38, 3959.309, 3961.238, 3963.166, 3965.095, 3967.023, 3968.952, 3970.88, 3972.809, 3974.737, 3976.666, 3978.594, 3980.523, 3982.452, 3984.38, 3986.309, 3988.237, 3990.166, 3992.094, 3994.023, 3995.951, 3997.88, 3999.809, 4001.737, 4003.666, 4005.594, 4007.523, 4009.451, 4011.38, 4013.308, 4015.237, 4017.166, 4019.094, 4021.022, 4022.951, 4024.88, 4026.808, 4028.737, 4030.665, 4032.594, 4034.522, 4036.451, 4038.379, 4040.308, 4042.237, 4044.165, 4046.094, 4048.022, 4049.951, 4051.879, 4053.808, 4055.736, 4057.665, 4059.594, 4061.522, 4063.451, 4065.379, 4067.308, 4069.236, 4071.165, 4073.093, 4075.022, 4076.95, 4078.879, 4080.808, 4082.736, 4084.665, 4086.593, 4088.522, 4090.45, 4092.379, 4094.307, 4096.236, 4098.165, 4100.093, 4102.021, 4103.95, 4105.878, 4107.807, 4109.736, 4111.664, 4113.593, 4115.521, 4117.45, 4119.378, 4121.307, 4123.235, 4125.164, 4127.093, 4129.021, 4130.95, 4132.878, 4134.807, 4136.735, 4138.664, 4140.592, 4142.521, 4144.45, 4146.378, 4148.307, 4150.235, 4152.164, 4154.092, 4156.021, 4157.949, 4159.878, 4161.807, 4163.735, 4165.664, 4167.592, 4169.521, 4171.449, 4173.378, 4175.306, 4177.235, 4179.164, 4181.092, 4183.021, 4184.949, 4186.877, 4188.806, 4190.735, 4192.663, 4194.592, 4196.521, 4198.449, 4200.377, 4202.306, 4204.234, 4206.163, 4208.092, 4210.02, 4211.949, 4213.877, 4215.806, 4217.734, 4219.663, 4221.591, 4223.52, 4225.449, 4227.377, 4229.306, 4231.234, 4233.163, 4235.091, 4237.02, 4238.948, 4240.877, 4242.806, 4244.734, 4246.663, 4248.591, 4250.52, 4252.448, 4254.377, 4256.305, 4258.234, 4260.163, 4262.091, 4264.02, 4265.948, 4267.876, 4269.805, 4271.734, 4273.662, 4275.591, 4277.52, 4279.448, 4281.376, 4283.305, 4285.233, 4287.162, 4289.091, 4291.019, 4292.948, 4294.876, 4296.805, 4298.733, 4300.662, 4302.59, 4304.519, 4306.448, 4308.376, 4310.305, 4312.233, 4314.162, 4316.09, 4318.019, 4319.947, 4321.876, 4323.805, 4325.733, 4327.662, 4329.59, 4331.519, 4333.447, 4335.376, 4337.304, 4339.233, 4341.162, 4343.09, 4345.019, 4346.947, 4348.875, 4350.804, 4352.733, 4354.661, 4356.59, 4358.519, 4360.447, 4362.375, 4364.304, 4366.232, 4368.161, 4370.09, 4372.018, 4373.947, 4375.875, 4377.804, 4379.732, 4381.661, 4383.589, 4385.518, 4387.447, 4389.375, 4391.304, 4393.232, 4395.161, 4397.089, 4399.018, 4400.946, 4402.875, 4404.804, 4406.732, 4408.661, 4410.589, 4412.518, 4414.446, 4416.375, 4418.303, 4420.232, 4422.161, 4424.089, 4426.018, 4427.946, 4429.875, 4431.803, 4433.732, 4435.66, 4437.589, 4439.518, 4441.446, 4443.375, 4445.303, 4447.231, 4449.16, 4451.089, 4453.017, 4454.946, 4456.875, 4458.803, 4460.731, 4462.66, 4464.588, 4466.517, 4468.446, 4470.374, 4472.303, 4474.231, 4476.16, 4478.088, 4480.017, 4481.945, 4483.874, 4485.803, 4487.731, 4489.66, 4491.588, 4493.517, 4495.445, 4497.374, 4499.302, 4501.231, 4503.16, 4505.088, 4507.017, 4508.945, 4510.874, 4512.802, 4514.731, 4516.659, 4518.588, 4520.517, 4522.445, 4524.374, 4526.302, 4528.23, 4530.159, 4532.088, 4534.016, 4535.945, 4537.874, 4539.802, 4541.73, 4543.659, 4545.587, 4547.516, 4549.445, 4551.373, 4553.302, 4555.23, 4557.159, 4559.087, 4561.016, 4562.944, 4564.873, 4566.802, 4568.73, 4570.659, 4572.587, 4574.516, 4576.444, 4578.373, 4580.301, 4582.23, 4584.159, 4586.087, 4588.016, 4589.944, 4591.873, 4593.801, 4595.73, 4597.658, 4599.587, 4601.516, 4603.444, 4605.373, 4607.301, 4609.229, 4611.158, 4613.087, 4615.015, 4616.944, 4618.873, 4620.801, 4622.729, 4624.658, 4626.586, 4628.515, 4630.444, 4632.372, 4634.301, 4636.229, 4638.158, 4640.086, 4642.015, 4643.943, 4645.872, 4647.801, 4649.729, 4651.658, 4653.586, 4655.515, 4657.443, 4659.372, 4661.3, 4663.229, 4665.158, 4667.086, 4669.015, 4670.943, 4672.872, 4674.8, 4676.729, 4678.657, 4680.586, 4682.515, 4684.443, 4686.372, 4688.3, 4690.229, 4692.157, 4694.086, 4696.014, 4697.943, 4699.872, 4701.8, 4703.729, 4705.657, 4707.585, 4709.514, 4711.443, 4713.371, 4715.3, 4717.229, 4719.157, 4721.085, 4723.014, 4724.942, 4726.871, 4728.8, 4730.728, 4732.657, 4734.585, 4736.514, 4738.442, 4740.371, 4742.299, 4744.228, 4746.157, 4748.085, 4750.014, 4751.942, 4753.871, 4755.799, 4757.728, 4759.656, 4761.585, 4763.514, 4765.442, 4767.371, 4769.299, 4771.228, 4773.156, 4775.085, 4777.013, 4778.942, 4780.871, 4782.799, 4784.728, 4786.656, 4788.584, 4790.513, 4792.442, 4794.37, 4796.299, 4798.228, 4800.156, 4802.084, 4804.013, 4805.941, 4807.87, 4809.799, 4811.727, 4813.656, 4815.584, 4817.513, 4819.441, 4821.37, 4823.298, 4825.227, 4827.156, 4829.084, 4831.013, 4832.941, 4834.87, 4836.798, 4838.727, 4840.655, 4842.584, 4844.513, 4846.441, 4848.37, 4850.298, 4852.227, 4854.155, 4856.084, 4858.012, 4859.941, 4861.87, 4863.798, 4865.727, 4867.655, 4869.583, 4871.512, 4873.441, 4875.369, 4877.298, 4879.227, 4881.155, 4883.083, 4885.012, 4886.94, 4888.869, 4890.798, 4892.726, 4894.655, 4896.583, 4898.512, 4900.44, 4902.369, 4904.297, 4906.226, 4908.155, 4910.083, 4912.012, 4913.94, 4915.869, 4917.797, 4919.726, 4921.654, 4923.583, 4925.512, 4927.44, 4929.369, 4931.297, 4933.226, 4935.154, 4937.083, 4939.011, 4940.94, 4942.869, 4944.797, 4946.726, 4948.654, 4950.583, 4952.511, 4954.44, 4956.368, 4958.297, 4960.226, 4962.154, 4964.083, 4966.011, 4967.939, 4969.868, 4971.797, 4973.725, 4975.654, 4977.583, 4979.511, 4981.439, 4983.368, 4985.296, 4987.225, 4989.154, 4991.082, 4993.011, 4994.939, 4996.868, 4998.796, 5000.725, 5002.653, 5004.582, 5006.511, 5008.439, 5010.368, 5012.296, 5014.225, 5016.153, 5018.082, 5020.01, 5021.939, 5023.868, 5025.796, 5027.725, 5029.653, 5031.582, 5033.51, 5035.439, 5037.367, 5039.296, 5041.225, 5043.153, 5045.082, 5047.01, 5048.938, 5050.867, 5052.796, 5054.724, 5056.653, 5058.582, 5060.51, 5062.438, 5064.367, 5066.295, 5068.224, 5070.153, 5072.081, 5074.01, 5075.938, 5077.867, 5079.795, 5081.724, 5083.652, 5085.581, 5087.51, 5089.438, 5091.367, 5093.295, 5095.224, 5097.152, 5099.081, 5101.009, 5102.938, 5104.867, 5106.795, 5108.724, 5110.652, 5112.581, 5114.509, 5116.438, 5118.366, 5120.295, 5122.224, 5124.152, 5126.081, 5128.009, 5129.938, 5131.866, 5133.795, 5135.723, 5137.652, 5139.581, 5141.509, 5143.438, 5145.366, 5147.294, 5149.223, 5151.152, 5153.08, 5155.009, 5156.938, 5158.866, 5160.794, 5162.723, 5164.651, 5166.58, 5168.509, 5170.437, 5172.366, 5174.294, 5176.223, 5178.151, 5180.08, 5182.008, 5183.937, 5185.866, 5187.794, 5189.723, 5191.651, 5193.58, 5195.508, 5197.437, 5199.365, 5201.294, 5203.223, 5205.151, 5207.08, 5209.008, 5210.937, 5212.865, 5214.794, 5216.722, 5218.651, 5220.58, 5222.508, 5224.437, 5226.365, 5228.293, 5230.222, 5232.151, 5234.079, 5236.008, 5237.937, 5239.865, 5241.793, 5243.722, 5245.65, 5247.579, 5249.508, 5251.436, 5253.365, 5255.293, 5257.222, 5259.15, 5261.079, 5263.007, 5264.936, 5266.865, 5268.793, 5270.722, 5272.65, 5274.579, 5276.507, 5278.436, 5280.364, 5282.293, 5284.222, 5286.15, 5288.079, 5290.007, 5291.936, 5293.864, 5295.793, 5297.721, 5299.65, 5301.579, 5303.507, 5305.436, 5307.364, 5309.292, 5311.221, 5313.15, 5315.078, 5317.007, 5318.936, 5320.864, 5322.792, 5324.721, 5326.649, 5328.578, 5330.507, 5332.435, 5334.364, 5336.292, 5338.221, 5340.149, 5342.078, 5344.006, 5345.935, 5347.864, 5349.792, 5351.721, 5353.649, 5355.578, 5357.506, 5359.435, 5361.363, 5363.292, 5365.221, 5367.149, 5369.078, 5371.006, 5372.935, 5374.863, 5376.792, 5378.72, 5380.649, 5382.578, 5384.506, 5386.435, 5388.363, 5390.292, 5392.22, 5394.149, 5396.077, 5398.006, 5399.935, 5401.863, 5403.792, 5405.72, 5407.648, 5409.577, 5411.506, 5413.434, 5415.363, 5417.292, 5419.22, 5421.148, 5423.077, 5425.005, 5426.934, 5428.863, 5430.791, 5432.72, 5434.648, 5436.577, 5438.505, 5440.434, 5442.362, 5444.291, 5446.22, 5448.148, 5450.077, 5452.005, 5453.934, 5455.862, 5457.791, 5459.719, 5461.648, 5463.577, 5465.505, 5467.434, 5469.362, 5471.291, 5473.219, 5475.148, 5477.076, 5479.005, 5480.934, 5482.862, 5484.791, 5486.719, 5488.647, 5490.576, 5492.505, 5494.433, 5496.362, 5498.291]
        self.abs = [6, 2.809911, 2.584419, 2.808356, 3.712419, 3.05345, 2.64086, 2.617561, 2.818566, 2.771725, 2.700782, 2.55059, 2.559523, 2.56604, 2.525492, 2.474835, 2.527095, 2.539105, 2.561054, 2.60473, 2.430391, 2.356727, 2.474882, 2.501314, 2.474517, 2.508896, 2.47437, 2.458125, 2.545397, 2.409446, 2.279186, 2.266725, 2.360302, 2.371389, 2.346, 2.388257, 2.398983, 2.352305, 2.322803, 2.314626, 2.380361, 2.389561, 2.336169, 2.34269, 2.342438, 2.300739, 2.291608, 2.369752, 2.345328, 2.268945, 2.322984, 2.307738, 2.271195, 2.299155, 2.362516, 2.372427, 2.314805, 2.238041, 2.227368, 2.246706, 2.243568, 2.257908, 2.233103, 2.222332, 2.25017, 2.26015, 2.294886, 2.318154, 2.313675, 2.234837, 2.188846, 2.199574, 2.216569, 2.178089, 2.16816, 2.233019, 2.265269, 2.187955, 2.161524, 2.158845, 2.165036, 2.185045, 2.203333, 2.164031, 2.163358, 2.168729, 2.165386, 2.170485, 2.170689, 2.167884, 2.189169, 2.193575, 2.197496, 2.22632, 2.217911, 2.169772, 2.154927, 2.133169, 2.14524, 2.164672, 2.172576, 2.200568, 2.200107, 2.209599, 2.239024, 2.205337, 2.134316, 2.119882, 2.109528, 2.116463, 2.12018, 2.089206, 2.058461, 2.022442, 1.957984, 1.865945, 1.77986, 1.709793, 1.624396, 1.539384, 1.469177, 1.403175, 1.338605, 1.275307, 1.22143, 1.174758, 1.127771, 1.080118, 1.041761, 1.00687, 0.9740061, 0.9432098, 0.9131041, 0.8851804, 0.8581328, 0.8334693, 0.810594, 0.7881059, 0.7682504, 0.7487025, 0.7296897, 0.7134026, 0.6978356, 0.680856, 0.6653977, 0.6515121, 0.6374634, 0.623399, 0.61114, 0.5987438, 0.5870104, 0.5757332, 0.5654148, 0.5551093, 0.5455431, 0.5363263, 0.5269114, 0.5184274, 0.5108668, 0.5030669, 0.4955336, 0.4882863, 0.4813298, 0.4742529, 0.4676665, 0.4616003, 0.4560756, 0.45116, 0.4455657, 0.4398971, 0.4348744, 0.4308904, 0.4269958, 0.4228746, 0.4192882, 0.4157691, 0.4120891, 0.4090727, 0.4072003, 0.4052129, 0.4029845, 0.4003222, 0.3976695, 0.3955081, 0.3932558, 0.3908885, 0.3886501, 0.386833, 0.3850608, 0.3834026, 0.3826758, 0.3820378, 0.3805138, 0.3791965, 0.3787299, 0.3783635, 0.3780987, 0.3785379, 0.3782313, 0.3776973, 0.3779593, 0.3789105, 0.3795032, 0.3796172, 0.3797402, 0.3801928, 0.3807903, 0.3808435, 0.3806429, 0.3814388, 0.3821334, 0.3813115, 0.3806396, 0.3808897, 0.3811972, 0.3811604, 0.3809172, 0.3812983, 0.3815401, 0.3816151, 0.3817536, 0.3810698, 0.3806322, 0.3808835, 0.380829, 0.3807213, 0.3804338, 0.379783, 0.3797266, 0.3793786, 0.3780451, 0.3769657, 0.3756602, 0.3745532, 0.3729551, 0.3701737, 0.3674607, 0.3653656, 0.3637308, 0.3623044, 0.3609676, 0.3588653, 0.357084, 0.3566563, 0.3566645, 0.3566295, 0.3564706, 0.3566417, 0.3573363, 0.3586985, 0.3599961, 0.361428, 0.3633297, 0.3652375, 0.3668198, 0.3681308, 0.3700424, 0.3717794, 0.3732797, 0.3743463, 0.3752604, 0.3759754, 0.3762725, 0.3771009, 0.3780553, 0.3780327, 0.3776083, 0.3775688, 0.3774799, 0.3769612, 0.3759083, 0.3753705, 0.3752016, 0.374132, 0.3738227, 0.3740774, 0.3736528, 0.3727623, 0.3720511, 0.3722605, 0.3719415, 0.3717054, 0.3715168, 0.370833, 0.3704205, 0.3697199, 0.3693618, 0.3689696, 0.3682326, 0.3681371, 0.3676011, 0.366879, 0.366815, 0.3666103, 0.3657698, 0.3651935, 0.3655632, 0.3659043, 0.3669137, 0.3682821, 0.3688384, 0.3699367, 0.3717662, 0.3740414, 0.3768233, 0.379945, 0.3840549, 0.3893833, 0.3952331, 0.4013347, 0.4072316, 0.4149866, 0.424387, 0.4337821, 0.4438105, 0.4553669, 0.4674466, 0.4802803, 0.4939437, 0.5087893, 0.5241243, 0.5386344, 0.553046, 0.5667923, 0.5791169, 0.5906469, 0.6009329, 0.6080946, 0.6128078, 0.6161841, 0.6174132, 0.6162488, 0.6127482, 0.6076013, 0.6016293, 0.5936023, 0.5830258, 0.5722525, 0.56137, 0.5484704, 0.5358182, 0.5235683, 0.5115482, 0.4988119, 0.4866238, 0.4746448, 0.4630392, 0.4514409, 0.4406384, 0.430328, 0.4201638, 0.4105142, 0.4016778, 0.3933871, 0.38548, 0.3778665, 0.3706771, 0.3640826, 0.358069, 0.3518607, 0.3463648, 0.3413142, 0.3366461, 0.3323799, 0.3286153, 0.3249859, 0.3220834, 0.3193584, 0.317179, 0.3159333, 0.3145762, 0.3135104, 0.3132317, 0.3132378, 0.3128006, 0.31205, 0.3116003, 0.3110509, 0.3099588, 0.3090657, 0.3086017, 0.3076706, 0.3059978, 0.3045217, 0.3032099, 0.3014089, 0.2994173, 0.2974116, 0.2957917, 0.293966, 0.2922052, 0.2908273, 0.2895985, 0.2882811, 0.286924, 0.2857123, 0.2846202, 0.2835001, 0.2825698, 0.2815265, 0.2806131, 0.2797475, 0.2794419, 0.2788655, 0.2780751, 0.277601, 0.2772132, 0.2766256, 0.2762163, 0.2760141, 0.2758502, 0.2756849, 0.2755488, 0.2755853, 0.2749996, 0.2743923, 0.2736839, 0.2732076, 0.2723197, 0.2711602, 0.2704082, 0.2692754, 0.2679501, 0.2671424, 0.266229, 0.2648418, 0.2636534, 0.2625815, 0.2614315, 0.2601675, 0.2589775, 0.2579189, 0.2568468, 0.2558407, 0.2554259, 0.2547421, 0.2539969, 0.253334, 0.2530118, 0.2526932, 0.2519593, 0.2511106, 0.2511031, 0.251175, 0.2510161, 0.2507929, 0.2502383, 0.2497799, 0.2495028, 0.2487897, 0.2480257, 0.2471393, 0.2466076, 0.2464205, 0.2452556, 0.2435505, 0.2423666, 0.2411402, 0.2398462, 0.2387077, 0.237503, 0.2363584, 0.2352881, 0.2342114, 0.2331908, 0.232002, 0.2309832, 0.2301228, 0.2293703, 0.2288268, 0.2280698, 0.227491, 0.2272691, 0.2268593, 0.2261583, 0.2255571, 0.2254291, 0.2251794, 0.2247693, 0.2245318, 0.2243749, 0.2238515, 0.2231455, 0.2223819, 0.2216394, 0.2208477, 0.2202644, 0.219737, 0.2187182, 0.2175668, 0.2161498, 0.2148401, 0.2134946, 0.2124932, 0.2116706, 0.2106097, 0.2094949, 0.2083493, 0.2073409, 0.2062783, 0.2048777, 0.2042067, 0.2037498, 0.2030981, 0.2028209, 0.2023883, 0.2020906, 0.2017505, 0.2014335, 0.2010878, 0.2009432, 0.2010912, 0.2012993, 0.2010277, 0.200619, 0.2001218, 0.1995257, 0.1993681, 0.1994021, 0.1988993, 0.1983639, 0.1978619, 0.1971745, 0.1963314, 0.1954514, 0.1944881, 0.1934178, 0.1921346, 0.1910447, 0.1904207, 0.1897933, 0.1887262, 0.1879172, 0.1874312, 0.1870729, 0.1863418, 0.1860718, 0.1862124, 0.1861308, 0.1859767, 0.1860626, 0.1862735, 0.1862369, 0.1862005, 0.1867065, 0.1872258, 0.1871434, 0.187108, 0.1872868, 0.1871214, 0.1869823, 0.1871612, 0.1871712, 0.1871947, 0.1867478, 0.1860991, 0.1856731, 0.1850915, 0.18442, 0.1838838, 0.1831886, 0.1824228, 0.1816495, 0.1810711, 0.1805796, 0.1801722, 0.1795267, 0.1789066, 0.1786997, 0.1787974, 0.1790604, 0.1789503, 0.1790839, 0.1796256, 0.1799782, 0.1803684, 0.1807721, 0.1810623, 0.181181, 0.1815513, 0.1821944, 0.1823519, 0.1826312, 0.1829698, 0.1832092, 0.1835858, 0.1836834, 0.1833493, 0.1830585, 0.1830765, 0.1831454, 0.1829572, 0.1825813, 0.182152, 0.1817011, 0.1814945, 0.1812892, 0.1806652, 0.1801916, 0.1800558, 0.1800383, 0.1798848, 0.1795757, 0.179518, 0.1798685, 0.1805904, 0.1810198, 0.1809651, 0.1813374, 0.1819081, 0.1824646, 0.1830385, 0.1834912, 0.1840061, 0.1849156, 0.1857163, 0.1862456, 0.1865777, 0.186945, 0.1875219, 0.1882425, 0.1883209, 0.1882623, 0.1884755, 0.188585, 0.1883563, 0.1879447, 0.1875321, 0.1872179, 0.1871896, 0.1871152, 0.1865566, 0.1856186, 0.1852951, 0.1852288, 0.1850448, 0.1851209, 0.1851854, 0.1853834, 0.185471, 0.1856575, 0.1863862, 0.1867884, 0.1871829, 0.1881068, 0.1888755, 0.1897379, 0.1904093, 0.1910744, 0.1919587, 0.1926589, 0.192833, 0.193453, 0.1940292, 0.1942807, 0.1947162, 0.1947025, 0.1947515, 0.194906, 0.1947598, 0.1947083, 0.1945999, 0.1941138, 0.193294, 0.1926506, 0.1924182, 0.1922016, 0.1918737, 0.1915814, 0.1915333, 0.1913326, 0.1911695, 0.19122, 0.1913848, 0.1919078, 0.1923976, 0.1926925, 0.1933818, 0.1943792, 0.1949578, 0.1961508, 0.1974068, 0.1981682, 0.1991508, 0.2002712, 0.2010668, 0.2018991, 0.2027174, 0.2038757, 0.204404, 0.2041832, 0.2044315, 0.2044851, 0.2041374, 0.2040227, 0.2045822, 0.2043812, 0.2029796, 0.2011801, 0.199868, 0.2005877, 0.2020072, 0.2018563, 0.2013982, 0.2014634, 0.2012477, 0.2008395, 0.2007871, 0.2003634, 0.1997915, 0.1995655, 0.1992646, 0.1986187, 0.19822, 0.1979736, 0.1976882, 0.1974309, 0.1975815, 0.19802, 0.1985471, 0.1988958, 0.1990326, 0.1995745, 0.1999785, 0.2003218, 0.2008355, 0.2009334, 0.200657, 0.2005977, 0.2005797, 0.200112, 0.1995657, 0.1991401, 0.1983924, 0.1979243, 0.1970174, 0.1957502, 0.1950998, 0.1945743, 0.1940808, 0.1937018, 0.1931137, 0.1925943, 0.1920006, 0.1915474, 0.191571, 0.1916617, 0.191761, 0.192173, 0.1922496, 0.1923071, 0.1927591, 0.1932703, 0.1939601, 0.1943314, 0.1946853, 0.1950428, 0.1952539, 0.1953806, 0.1958726, 0.1964499, 0.1967525, 0.1964318, 0.1960172, 0.1958951, 0.1955275, 0.1947629, 0.1943135, 0.1936565, 0.1927905, 0.1919928, 0.1912262, 0.1904925, 0.1895275, 0.1887485, 0.188168, 0.1875639, 0.1868976, 0.1864596, 0.1861799, 0.1861219, 0.1862968, 0.1866805, 0.1871402, 0.1874245, 0.1877681, 0.1883016, 0.1888558, 0.189541, 0.1903484, 0.19122, 0.1917404, 0.1925102, 0.1932244, 0.1937911, 0.1943329, 0.1949981, 0.1956066, 0.1956937, 0.1959157, 0.196618, 0.1966236, 0.1961073, 0.1957932, 0.1955882, 0.1950763, 0.1946687, 0.1942834, 0.1942308, 0.194446, 0.194176, 0.1936952, 0.1937474, 0.1942627, 0.1944844, 0.1944792, 0.1948375, 0.1955983, 0.1964907, 0.1973785, 0.1985694, 0.2000106, 0.2013186, 0.2026036, 0.2038862, 0.205303, 0.2069482, 0.2081944, 0.2094131, 0.2107667, 0.2120471, 0.213355, 0.2145545, 0.2155083, 0.2163853, 0.2174317, 0.2183134, 0.2187298, 0.2191567, 0.219533, 0.2197518, 0.2201093, 0.2204462, 0.2209414, 0.221518, 0.2218491, 0.2223717, 0.2229421, 0.2233013, 0.2236519, 0.2247308, 0.2257883, 0.2266486, 0.2279437, 0.2292609, 0.2305083, 0.2319694, 0.2333394, 0.2353611, 0.237664, 0.2394134, 0.2412019, 0.2432096, 0.2449057, 0.2464252, 0.2481527, 0.2497004, 0.2513571, 0.2533349, 0.2549604, 0.2564063, 0.2576267, 0.2584602, 0.2594226, 0.2606592, 0.2615196, 0.2622694, 0.2630979, 0.2639963, 0.2646917, 0.2656008, 0.2663474, 0.2671357, 0.2681949, 0.2692031, 0.2700333, 0.2710515, 0.2723428, 0.2734717, 0.2750945, 0.277207, 0.2790537, 0.2807562, 0.2827653, 0.2847575, 0.2870479, 0.2893199, 0.2908331, 0.2924654, 0.294811, 0.2969494, 0.2990616, 0.3012558, 0.3033505, 0.3054492, 0.3073034, 0.308663, 0.3101889, 0.3118573, 0.3129348, 0.313933, 0.315576, 0.3174817, 0.3185601, 0.3196135, 0.3206206, 0.3216187, 0.3231563, 0.3247257, 0.3259636, 0.3272531, 0.3288736, 0.3306956, 0.3321009, 0.3337192, 0.3360254, 0.3386102, 0.3406349, 0.3426947, 0.3450929, 0.3471919, 0.3493817, 0.3517561, 0.3542138, 0.3566263, 0.3588732, 0.3616004, 0.3641211, 0.3661453, 0.3686448, 0.3709482, 0.3731796, 0.3757948, 0.377916, 0.3796021, 0.3819255, 0.3832754, 0.3846175, 0.3868189, 0.3889149, 0.3901658, 0.3915583, 0.3941348, 0.3966806, 0.3986137, 0.4009028, 0.403448, 0.4057592, 0.407764, 0.4098533, 0.4119411, 0.4143269, 0.4170642, 0.4194744, 0.4218469, 0.4246615, 0.4275473, 0.4301462, 0.4332305, 0.4363823, 0.438618, 0.4409696, 0.4438124, 0.4469908, 0.4494701, 0.4519728, 0.454475, 0.4569948, 0.4600439, 0.4631211, 0.4654011, 0.4675904, 0.4704528, 0.4729466, 0.4755199, 0.4784678, 0.4807293, 0.4827152, 0.4845216, 0.4872283, 0.4910095, 0.4943489, 0.4972995, 0.5000304, 0.5023621, 0.5050912, 0.5082149, 0.511531, 0.5144317, 0.5169416, 0.5196877, 0.5228828, 0.5261642, 0.5293858, 0.5327082, 0.5355193, 0.5385958, 0.5422941, 0.5460047, 0.5488046, 0.5513212, 0.5550522, 0.5581263, 0.561218, 0.5642759, 0.5675619, 0.5709786, 0.5739694, 0.5770267, 0.5806141, 0.583872, 0.5868359, 0.589359, 0.5926427, 0.5952688, 0.59762, 0.6006814, 0.6045951, 0.6083178, 0.6105647, 0.6133479, 0.6169907, 0.6204504, 0.6232641, 0.6264411, 0.6300343, 0.6341387, 0.63781, 0.642082, 0.6461749, 0.6494706, 0.6526488, 0.6566269, 0.660301, 0.6636286, 0.6683034, 0.6722538, 0.6756909, 0.6794418, 0.6833875, 0.6868873, 0.6900824, 0.6932869, 0.6973095, 0.7007965, 0.7044527, 0.7091004, 0.7125696, 0.7155105, 0.7190796, 0.7226695, 0.7259187, 0.7312222, 0.7356591, 0.737556, 0.7419013, 0.7465073, 0.7505993, 0.7545161, 0.7587864, 0.761495, 0.7650331, 0.769484, 0.7743101, 0.7795499, 0.7841832, 0.7875065, 0.7906433, 0.7956318, 0.8020933, 0.807215, 0.8107692, 0.8149133, 0.8192353, 0.8240506, 0.8283909, 0.8315005, 0.836186, 0.8417534, 0.8450218, 0.8491948, 0.853162, 0.856663, 0.8615958, 0.8666423, 0.8702988, 0.8745135, 0.8803098, 0.8843889, 0.8879765, 0.8943189, 0.8993045, 0.9017553, 0.9044774, 0.909491, 0.9159847, 0.9210892, 0.9232451, 0.9273307, 0.9345137, 0.9399011, 0.9434788, 0.9484215, 0.9534835, 0.9587649, 0.9655019, 0.9703298, 0.9749373, 0.9797631, 0.9832234, 0.9874178, 0.993164, 0.9985796, 1.002605, 1.007489, 1.013217, 1.018376, 1.023511, 1.026581, 1.032528, 1.038385, 1.044036, 1.047882, 1.051703, 1.055522, 1.061174, 1.067126, 1.07201, 1.075502, 1.080756, 1.088823, 1.094739, 1.09454, 1.097234, 1.09981, 1.106279, 1.11379, 1.119824, 1.122811, 1.124259, 1.129889, 1.1355, 1.139033, 1.141525, 1.142404, 1.146981, 1.15299, 1.156503, 1.160955, 1.167949, 1.173193, 1.175469, 1.178391, 1.18028, 1.184065, 1.193093, 1.197257, 1.197577, 1.198115, 1.202493, 1.207671, 1.209679, 1.212618, 1.216514, 1.220852, 1.224627, 1.228054, 1.231026, 1.235852, 1.242012, 1.244255, 1.24702, 1.252333, 1.256381, 1.257801, 1.261114, 1.265794, 1.270302, 1.276213, 1.28368, 1.291001, 1.293421, 1.290845, 1.292584, 1.298475, 1.302684, 1.311793, 1.320575, 1.326813, 1.333516, 1.33599, 1.338643, 1.344977, 1.352138, 1.355571, 1.355919, 1.358432, 1.366062, 1.372087, 1.374636, 1.380655, 1.388709, 1.39242, 1.396113, 1.402008, 1.408534, 1.411325, 1.411974, 1.411546, 1.418375, 1.429223, 1.43848, 1.440477, 1.435133, 1.438288, 1.444536, 1.445975, 1.452253, 1.463802, 1.47214, 1.477818, 1.480374, 1.478594, 1.480565, 1.49776, 1.505301, 1.498875, 1.500341, 1.510138, 1.514, 1.509408, 1.5082, 1.518406, 1.52392, 1.520376, 1.52236, 1.528253, 1.535965, 1.546833, 1.551748, 1.551557, 1.551368, 1.549603, 1.549237, 1.55323, 1.561345, 1.571682, 1.57836, 1.573344, 1.575195, 1.582613, 1.584064, 1.58592, 1.587811, 1.583748, 1.586821, 1.589965, 1.605747, 1.620761, 1.613367, 1.613829, 1.616425, 1.604785, 1.604218, 1.611447, 1.610348, 1.610214, 1.620168, 1.626304, 1.627343, 1.632901, 1.631945, 1.62017, 1.614244, 1.632558, 1.643733, 1.642164, 1.63973, 1.633769, 1.638146, 1.649179, 1.643302, 1.636835, 1.636882, 1.640116, 1.644707, 1.652358, 1.649899, 1.657457, 1.667221, 1.669759, 1.676242, 1.668263, 1.662573, 1.660036, 1.662808, 1.676477, 1.669572, 1.661931, 1.669796, 1.666767, 1.646983, 1.644258, 1.659219, 1.653879, 1.656425, 1.668983, 1.669056, 1.653196, 1.63473, 1.630388, 1.626081, 1.631044, 1.643341, 1.648612, 1.628581, 1.619869, 1.623696, 1.617147, 1.60829, 1.601933, 1.597543, 1.587024, 1.569851, 1.56157, 1.555982, 1.543521, 1.523905, 1.505746, 1.494144, 1.483539, 1.468145, 1.456089, 1.439306, 1.416587, 1.398029, 1.376532, 1.35577, 1.340719, 1.315287, 1.289885, 1.264339, 1.237738, 1.214313, 1.190893, 1.163454, 1.133173, 1.105823, 1.075927, 1.04517, 1.017118, 0.9852895, 0.9563445, 0.9264469, 0.8952277, 0.8651094, 0.8358402, 0.8064507, 0.7777146, 0.7492694, 0.7199276, 0.6907836, 0.6625207, 0.6346226, 0.6074951, 0.5822212, 0.5567493, 0.5313763, 0.5085259, 0.4866311, 0.4651466, 0.4445795, 0.4247373, 0.4061828, 0.3881924, 0.371428, 0.3559973, 0.3397812, 0.3253371, 0.3124241, 0.2998654, 0.2891782, 0.2791178, 0.2682544, 0.2582697, 0.250687, 0.2433593, 0.235557, 0.2285315, 0.2225568, 0.2165418, 0.2100675, 0.2049636, 0.2001753, 0.1952358, 0.1902489, 0.1857466, 0.181873, 0.1781066, 0.1740913, 0.1702793, 0.166522, 0.1633617, 0.1608012, 0.1578833, 0.1548599, 0.1525069, 0.1504148, 0.1481647, 0.1457717, 0.143434, 0.1421796, 0.1411279, 0.1395015, 0.138746, 0.1382392, 0.1374571, 0.1368304, 0.1362595, 0.1363963, 0.1362911, 0.1364062, 0.1364696, 0.1358957, 0.1357031, 0.1359352, 0.1359183, 0.1353884, 0.1354096, 0.1355673, 0.1352368, 0.1349425, 0.1344611, 0.1333005, 0.1323313, 0.1314017, 0.1304155, 0.1297777, 0.1294155, 0.1286489, 0.1278426, 0.1277077, 0.1268997, 0.1255915, 0.1251176, 0.1248427, 0.1242423, 0.1238135, 0.124403, 0.1246228, 0.1243854, 0.1240761, 0.1243432, 0.1247863, 0.1251201, 0.1256041, 0.1263928, 0.1267004, 0.1267389, 0.1265326, 0.1270795, 0.127824, 0.1279861, 0.1277988, 0.1280439, 0.1281761, 0.127971, 0.127688, 0.1274358, 0.1268586, 0.1265467, 0.1262918, 0.1255211, 0.1248783, 0.1246087, 0.1237998, 0.1227459, 0.1229518, 0.122906, 0.1223867, 0.1222202, 0.1221407, 0.12188, 0.1213757, 0.1214387, 0.1217908, 0.1217738, 0.1221396, 0.1225364, 0.1227308, 0.1228682, 0.123373, 0.1243113, 0.1248468, 0.1250143, 0.1251815, 0.1252638, 0.1255233, 0.1258988, 0.12597, 0.1266047, 0.1268314, 0.1266714, 0.1260969, 0.1253332, 0.1247513, 0.1242281, 0.1235708, 0.1227376, 0.1229622, 0.1234123, 0.1230907, 0.1223012, 0.1217984, 0.1214672, 0.1204794, 0.1202341, 0.1209838, 0.1212109, 0.121208, 0.1208485, 0.1204649, 0.120749, 0.1213734, 0.1213787, 0.1218011, 0.1220658, 0.1221177, 0.1222072, 0.1222344, 0.1226849, 0.1232811, 0.1236096, 0.1239432, 0.1243996, 0.1241184, 0.1240257, 0.1243099, 0.1241985, 0.1238536, 0.1235524, 0.123345, 0.1230355, 0.1223055, 0.1220692, 0.1224453, 0.12172, 0.1204912, 0.1197674, 0.1194118, 0.1192753, 0.1192114, 0.1191379, 0.1185815, 0.1185854, 0.118951, 0.11886, 0.1186122, 0.1183392, 0.1186887, 0.1189656, 0.1188779, 0.1186294, 0.1190112, 0.1196559, 0.1202181, 0.1200529, 0.1198575, 0.1203698, 0.121034, 0.1209375, 0.1207469, 0.1209948, 0.1209253, 0.1208008, 0.1206631, 0.1207638, 0.1207645, 0.1205814, 0.1199591, 0.118678, 0.1177707, 0.1178377, 0.1173902, 0.1168356, 0.1163012, 0.1157267, 0.1160716, 0.115909, 0.1155796, 0.1151533, 0.1148189, 0.114628, 0.1151177, 0.1156635, 0.1150815, 0.1145683, 0.1149961, 0.1152174, 0.1157824, 0.1163018, 0.1162402, 0.1161606, 0.116672, 0.1170961, 0.1171818, 0.1173969, 0.1179503, 0.1179403, 0.1174746, 0.1167929, 0.1164507, 0.1164503, 0.1161303, 0.1157491, 0.1156176, 0.1149108, 0.1142234, 0.113915, 0.114016, 0.1140616, 0.1132086, 0.1119136, 0.1114502, 0.1110785, 0.1106038, 0.1103696, 0.110352, 0.1101581, 0.1104713, 0.1107337, 0.1102902, 0.1104635, 0.1106096, 0.1107451, 0.1113533, 0.1120313, 0.1122765, 0.1123923, 0.1123707, 0.1126708, 0.1130021, 0.1128636, 0.1129328, 0.1135697, 0.1137935, 0.1136633, 0.1128164, 0.1123807, 0.1124841, 0.1125251, 0.1123749, 0.1119401, 0.1111005, 0.1104414, 0.1101423, 0.1097938, 0.1091831, 0.1088561, 0.1087758, 0.1085485, 0.1081761, 0.1078799, 0.1075963, 0.1080332, 0.1087736, 0.108596, 0.108809, 0.1089938, 0.1090047, 0.1093856, 0.1099615, 0.1100456, 0.109935, 0.1103018, 0.1107384, 0.1110497, 0.1107598, 0.1107873, 0.1118753, 0.1125988, 0.1123026, 0.1126876, 0.1130597, 0.1123794, 0.1117676, 0.1111878, 0.1111063, 0.1112785, 0.1108173, 0.1103071, 0.109966, 0.1096142, 0.109626, 0.1098181, 0.1091232, 0.1084401, 0.1082311, 0.1081019, 0.1085292, 0.1081095, 0.1072175, 0.1077446, 0.1084282, 0.1084051, 0.1088339, 0.1089358, 0.1096676, 0.1111258, 0.1118521, 0.1116939, 0.1120128, 0.112445, 0.1130025, 0.1137945, 0.1140403, 0.1139583, 0.113971, 0.113898, 0.1136212, 0.1138003, 0.1147071, 0.1147582, 0.1143847, 0.1147661, 0.1148265, 0.1141395, 0.1126139, 0.1121934, 0.1126614, 0.1126015, 0.1123761, 0.1119277, 0.1114311, 0.1114531, 0.1117288, 0.1118679, 0.1124842, 0.1130232, 0.1130692, 0.1121648, 0.11234, 0.1132963, 0.113408, 0.1141615, 0.1150172, 0.1153578, 0.1156251, 0.1156818, 0.1161883, 0.1175441, 0.1178444, 0.1177826, 0.1181689, 0.1186926, 0.1187873, 0.1183344, 0.1187332, 0.1194631, 0.1195124, 0.1186646, 0.1187121, 0.1184412, 0.1183183, 0.118743, 0.1192281, 0.1189951, 0.1186125, 0.1182929, 0.1177335, 0.1171073, 0.1165258, 0.1159631, 0.1161592, 0.1163613, 0.1165697, 0.116369, 0.1157715, 0.1161889, 0.1168424, 0.1166887, 0.1174271, 0.1188878, 0.1199984, 0.1203947, 0.1205979, 0.1212049, 0.1216724, 0.1219571, 0.1226595, 0.1224509, 0.1217851, 0.1216372, 0.1219315, 0.1226434, 0.1230314, 0.1228916, 0.1228795, 0.1230411, 0.1225141, 0.1218815, 0.1217202, 0.1216663, 0.1216139, 0.12049, 0.1191067, 0.1186131, 0.1179359, 0.1185727, 0.1193464, 0.1181719, 0.1173159, 0.1172634, 0.1177435, 0.1172134, 0.1171349, 0.1178631, 0.1183585, 0.1185136, 0.1192784, 0.119565, 0.1189249, 0.1188819, 0.1190844, 0.1191707, 0.1198363, 0.1199062, 0.1195259, 0.1192058, 0.1187342, 0.1185696, 0.1187588, 0.1198078, 0.119637, 0.1186437, 0.1185921, 0.1177444, 0.1163215, 0.1161537, 0.1156105, 0.1146946, 0.1147464, 0.114778, 0.1140899, 0.1139196, 0.1133953, 0.1128808, 0.1129251, 0.1126081, 0.1119193, 0.1118826, 0.1125576, 0.1130488, 0.1126616, 0.1127237, 0.1124909, 0.1120215, 0.1127718, 0.114222, 0.1143805, 0.1143894, 0.1155689, 0.115546, 0.1151725, 0.1151897, 0.1146612, 0.1145053, 0.1156168, 0.1154277, 0.1153318, 0.1153777, 0.1149628, 0.1149356, 0.1140117, 0.11358, 0.1137111, 0.1131157, 0.1128316, 0.1127626, 0.1125235, 0.1121508, 0.1113298, 0.1106836, 0.1101894, 0.1093838, 0.1091318, 0.1100453, 0.1108556, 0.111205, 0.1118955, 0.111697, 0.1109764, 0.1109964, 0.1115911, 0.1129909, 0.1130262, 0.1136973, 0.1143276, 0.1145361, 0.114565, 0.1148388, 0.115197, 0.1157619, 0.1151246, 0.1137463, 0.1140437, 0.1150585, 0.1151798, 0.1148369, 0.1150332, 0.1150895, 0.1147864, 0.1146547, 0.1137031, 0.1133349, 0.1140225, 0.1136163, 0.1123372, 0.1115878, 0.1115848, 0.1113908, 0.1112447, 0.1116966, 0.1119881, 0.1115824, 0.1116171, 0.1112667, 0.1111019, 0.1110064, 0.1119402, 0.1131666, 0.1140653, 0.1145609, 0.1151418, 0.1148613, 0.114479, 0.115121, 0.1156238, 0.1156249, 0.1155928, 0.1155349, 0.1156141, 0.115467, 0.115582, 0.1163892, 0.1165434, 0.1165537, 0.1160101, 0.1157506, 0.1161026, 0.1162366, 0.1153361, 0.1139467, 0.1133608, 0.113027, 0.1125358, 0.1132471, 0.1136337, 0.1140776, 0.1146434, 0.113822, 0.1130584, 0.1131944, 0.1138555, 0.1141297, 0.1146058, 0.1154415, 0.114779, 0.1144274, 0.1152351, 0.1151168, 0.1149418, 0.1154485, 0.1161339, 0.11627, 0.1154171, 0.1155247, 0.1170076, 0.1178607, 0.1178751, 0.1172021, 0.1171495, 0.1172777, 0.1176069, 0.1176011, 0.1172092, 0.1166124, 0.1164536, 0.1172569, 0.1170727, 0.1163092, 0.116511, 0.1165697, 0.1159062, 0.116285, 0.1165125, 0.1156197, 0.1157042, 0.115917, 0.1157657, 0.1156395, 0.1148755, 0.1145344, 0.1147827, 0.11575, 0.1157369, 0.1152294, 0.1160214, 0.1172994, 0.1184247, 0.1189383, 0.1190812, 0.1191411, 0.1193115, 0.1196651, 0.1183574, 0.1176744, 0.1179858, 0.1182138, 0.1181493, 0.1183625, 0.1184978, 0.1186078, 0.1181048, 0.1177379, 0.118271, 0.1183095, 0.1172212, 0.1167305, 0.1172946, 0.1170145, 0.1162439, 0.1165174, 0.1169399, 0.1170172, 0.1161878, 0.1155129, 0.1166813, 0.1170562, 0.1163602, 0.1160657, 0.1162053, 0.1168653, 0.1182057, 0.1182455, 0.118054, 0.1182828, 0.1181969, 0.1181312, 0.1192332, 0.1196324, 0.1193682, 0.119738, 0.120637, 0.1203186, 0.1199364, 0.1207284, 0.1209681, 0.1202775, 0.1192179, 0.1190459, 0.1188875, 0.1192699, 0.1197655, 0.1190584, 0.1185211, 0.1189544, 0.119104, 0.1190098, 0.1189676, 0.118066, 0.1179017, 0.1172471, 0.1174275, 0.1184915, 0.1189807, 0.1194473, 0.1198554, 0.119273, 0.1189157, 0.1197482, 0.1195794, 0.1191558, 0.1197564, 0.1211814, 0.1221345, 0.1211031, 0.1206588, 0.1215611, 0.1223465, 0.1222855, 0.1207654, 0.1198444, 0.1206231, 0.1221827, 0.122563, 0.1220845, 0.122068, 0.1217277, 0.1208954, 0.1210869, 0.1221011, 0.1218916, 0.1209316, 0.1203831, 0.120584, 0.1209275, 0.1215878, 0.1218317, 0.121406, 0.120707, 0.1207972, 0.1206968, 0.1208634, 0.1200643, 0.1204447, 0.1216729, 0.1216671, 0.121241, 0.1220204, 0.1224117, 0.1227576, 0.1220549, 0.1214841, 0.122565, 0.1227259, 0.1217879, 0.1224869, 0.1238134, 0.1243092, 0.1236826, 0.1240425, 0.1242748, 0.1238869, 0.1232506, 0.1226066, 0.1219173, 0.1219345, 0.1231182, 0.1229278, 0.1230934, 0.1235793, 0.1235409, 0.1231424, 0.1219265, 0.1215785, 0.1223871, 0.1228023, 0.1223334, 0.1224317, 0.1239025, 0.1250883, 0.1254813, 0.1249708, 0.1242843, 0.1239404, 0.1240439, 0.123755, 0.1240651, 0.123356, 0.1229573, 0.1251609, 0.1260161, 0.1253947, 0.1258801, 0.1256511, 0.1259105, 0.1264316, 0.1264209, 0.1262141, 0.1254525, 0.1259064, 0.1257329, 0.1257096, 0.1262816, 0.1257542, 0.1242018, 0.1242773, 0.1251421, 0.1247249, 0.1237704, 0.1228849, 0.1229146, 0.122787, 0.1231651, 0.1239258, 0.1226226, 0.123396, 0.1248023, 0.1244688, 0.1229971, 0.1211136, 0.1213547, 0.1221339, 0.1219363, 0.1209049, 0.1202558, 0.1208133, 0.1216508, 0.121405, 0.1212448, 0.1212944, 0.1208543, 0.1205082, 0.1197649, 0.1194979, 0.1200961, 0.1205315, 0.1203474, 0.119951, 0.1205586, 0.1200172, 0.1188719, 0.1186907, 0.1191892, 0.1189174, 0.1183042, 0.1182791, 0.117956, 0.1177624, 0.1179421, 0.1177524, 0.1171093, 0.1163419, 0.1170336, 0.1178668, 0.1178582, 0.1173674, 0.1164726, 0.1173731, 0.1171331, 0.1164603, 0.1173585, 0.1189696, 0.1193265, 0.1183773, 0.1177463, 0.1181726, 0.1187382, 0.1190953, 0.1185447, 0.1175708, 0.1175783, 0.1187023, 0.1199047, 0.1199792, 0.1190481, 0.1198213, 0.1200863, 0.119048, 0.1188149, 0.1187753, 0.1174143, 0.1166817, 0.1166825, 0.1177637, 0.1171481, 0.1163508, 0.1162065, 0.116321, 0.1171207, 0.1178584, 0.1186085, 0.1178077, 0.1168615, 0.1171663, 0.1179734, 0.1174067, 0.1169582, 0.1172139, 0.1178937, 0.117985, 0.1185911, 0.1188342, 0.1182626, 0.1177698, 0.1178107, 0.1172025, 0.1171319, 0.1181804, 0.1186603, 0.1183812, 0.1179715, 0.1183801, 0.118408, 0.1170161, 0.1161184, 0.1158662, 0.1164956, 0.1169504, 0.1159166, 0.1163649, 0.1181391, 0.1185993, 0.1178075, 0.1159317, 0.1158979, 0.1157886, 0.1159211, 0.1169969, 0.1166619, 0.115827, 0.116855, 0.1182221, 0.1187476, 0.1191454, 0.1184304, 0.1164618, 0.1171881, 0.117836, 0.1179089, 0.1183465, 0.1177676, 0.1176966, 0.1172776, 0.1175373, 0.1184605, 0.1189293, 0.1183366, 0.1174597, 0.1175526, 0.1175063, 0.1169238]
        self.df = pd.DataFrame({"Wavenumber": self.wn, "Absorbance": self.abs})
        self.df.set_index("Wavenumber", inplace=True)
        self.dfs_dict = {self.file: self.df}
        self.decimalPlace = 5

    def test_Gauss(self):
        x = np.array([-2, -1, 0, 1, 2])
        mu = 0
        sd = 1
        A = 2
        expected_output = np.array(
            [0.27067057, 1.21306132, 2.0000000, 1.21306132, 0.27067057]
        )
        result = pig.gauss(x, mu, sd, A)

        self.assertAlmostEqual(
            result[0],
            expected_output[0],
            self.decimalPlace,
            msg="Output test and expected values from Gauss function " "do not agree",
        )

    def test_Linear(self):
        x = np.array([-2, -1, 0, 1, 2])
        m = 1
        b = 0
        expected_output = np.array([0, 1, 2, 3, 4])

        result = pig.linear(x, m, b)

        self.assertAlmostEqual(
            result[0],
            expected_output[0],
            self.decimalPlace,
            msg="Output test and expected values from Linear function " "do not agree",
        )

    def test_NIR(self):
        for _, data in self.dfs_dict.items():
            H2Om_5200_peak_ranges = [(4875, 5400), (4850, 5375), (4900, 5425)]
            H2Om_5200_results = list(
                map(
                    lambda peak_range: {
                        "peak_fit": (
                            result := pig.NIR_process(
                                data, peak_range[0], peak_range[1], "H2Om"
                            )
                        )[0],
                        "peak_krige": result[1],
                        "PH_krige": result[2],
                        "STN": result[3],
                    },
                    H2Om_5200_peak_ranges,
                )
            )

            PH_5200_krige = [result["PH_krige"] for result in H2Om_5200_results]
            PH_5200_krige_M = np.mean(PH_5200_krige)

        result = PH_5200_krige_M
        expected = 0.008959072
        self.assertAlmostEqual(
            result,
            expected,
            self.decimalPlace,
            msg="H2Om5200 peak height test and expected values from the "
            "NearIR_Process function do not agree",
        )

    def test_NIR_invalid_peak_type(self):
        valid_data = next(iter(self.dfs_dict.values()))
        invalid_peak_type = "InvalidPeakType"

        with self.assertRaises(ValueError) as context:
            pig.NIR_process(valid_data, 4875, 5400, invalid_peak_type)

        self.assertTrue(
            f"Invalid peak type: {invalid_peak_type}" in str(context.exception)
        )

    def test_MIR(self):
        for _, data in self.dfs_dict.items():
            H2Ot_3550_peak_ranges = [(1900, 4400), (2100, 4200), (2300, 4000)]
            H2Ot_3550_results = list(
                map(
                    lambda peak_range: {
                        "peak_fit": (
                            result := pig.MIR_process(
                                data, peak_range[0], peak_range[1]
                            )
                        )[0],
                        "plot_output": result[1],
                        "PH": result[2],
                    },
                    H2Ot_3550_peak_ranges,
                )
            )

            PH_3550 = [result["PH"] for result in H2Ot_3550_results]
            PH_3550_M = np.mean(PH_3550)

        result = PH_3550_M
        expected = 1.523342931
        self.assertAlmostEqual(
            result,
            expected,
            self.decimalPlace,
            msg="H2Ot3550 peak height test and expected values from the "
            "NearIR_Process function do not agree",
        )

    def test_MCMC(self):
        Volatiles_DF, _ = pig.calculate_baselines(self.dfs_dict, None)

        result_H2Om_5200 = float(Volatiles_DF["PH_5200_M"].iloc[0])
        expected_H2Om_5200 = 0.00895907201720743

        result_H2Ot_3550 = float(Volatiles_DF["PH_3550_M"].iloc[0])
        expected_H2Ot_3550 = 1.52334293070956

        result_CO2_1515 = float(Volatiles_DF["PH_1515_BP"].iloc[0])
        expected_CO2_1515 = 0.057289618537916066

        self.assertAlmostEqual(
            result_H2Om_5200,
            expected_H2Om_5200,
            self.decimalPlace,
            msg="H2Om_5200 peak height test and expected values from the "
            "calculate_baselines function do not agree",
        )

        self.assertAlmostEqual(
            result_H2Ot_3550,
            expected_H2Ot_3550,
            self.decimalPlace,
            msg="H2Ot_3550 peak height test and expected values from the "
            "calculate_baselines function do not agree",
        )

        self.assertAlmostEqual(
            result_CO2_1515,
            expected_CO2_1515,
            self.decimalPlace - 3,
            msg="CO2_1515 peak height test and expected values from the "
            "calculate_baselines function do not agree",
        )

    def test_MCMC_interp(self):
        first_index = self.df.index > 1255
        if any(first_index):
            first_index_position = np.argmax(first_index)
            drop_indices = self.df.index[
                first_index_position : first_index_position + 3
            ]
            self.df_interp = self.df.drop(drop_indices)

        self.dfs_dict_interp = {self.file: self.df_interp}

        Volatiles_DF, _ = pig.calculate_baselines(self.dfs_dict_interp, None)

        result_H2Om_5200 = float(Volatiles_DF["PH_5200_M"].iloc[0])
        expected_H2Om_5200 = 0.00895907201720743

        result_H2Ot_3550 = float(Volatiles_DF["PH_3550_M"].iloc[0])
        expected_H2Ot_3550 = 1.52334293070956

        result_CO2_1515 = float(Volatiles_DF["PH_1515_BP"].iloc[0])
        expected_CO2_1515 = 0.057289618537916066

        self.assertAlmostEqual(
            result_H2Om_5200,
            expected_H2Om_5200,
            self.decimalPlace,
            msg="H2Om_5200 peak height test and expected values from the "
            "calculate_baselines function do not agree",
        )

        self.assertAlmostEqual(
            result_H2Ot_3550,
            expected_H2Ot_3550,
            self.decimalPlace,
            msg="H2Ot_3550 peak height test and expected values from the "
            "calculate_baselines function do not agree",
        )

        self.assertAlmostEqual(
            result_CO2_1515,
            expected_CO2_1515,
            self.decimalPlace - 3,
            msg="CO2_1515 peak height test and expected values from the "
            "calculate_baselines function do not agree",
        )

    def test_MCMC_exportpath(self):
        
        temp_export_path = "temp_test_dir"
        base_path = os.getcwd()

        # Use the new create_output_dirs function
        paths = pig.create_output_dirs(base_path, temp_export_path)

        # Check if all expected directories are created
        expected_dirs = [
            "FIGURES",
            "PLOTFILES",
            "NPZTXTFILES",
            "LOGFILES",
            "PKLFILES",
            "BLPEAKFILES",
            "FINALDATA",
        ]
        for dir_name in expected_dirs:
            if dir_name == "FINALDATA":
                expected_path = os.path.join(base_path, dir_name)
            else:
                expected_path = os.path.join(base_path, dir_name, temp_export_path)
            self.assertTrue(os.path.exists(expected_path), f"{dir_name} directory not created")

        # Check for additional directories in PLOTFILES
        add_dirs = ["TRACE", "HISTOGRAM", "PAIRWISE", "MODELFIT"]
        plotfile_path = paths["PLOTFILES"]
        for add_dir in add_dirs:
            self.assertTrue(os.path.exists(os.path.join(plotfile_path, add_dir)), 
                            f"{add_dir} not created in PLOTFILES")

        # Run the calculate_baselines function
        Volatiles_DF, _ = pig.calculate_baselines(self.dfs_dict, temp_export_path)
        
        # Check if the result was exported correctly
        fdata = paths["FINALDATA"]
        Volatiles_DF.to_csv(os.path.join(fdata, "output.csv"))
        self.assertTrue(os.path.exists(os.path.join(fdata, "output.csv")))

        # Check for figure files
        # fpath = paths["FIGURES"]
        # figure_files = glob.glob(os.path.join(fpath, "*.pdf"))        
        # figure_files = glob.glob(os.path.join(fpath, "**", "*.pdf"), recursive=True)
        # self.assertTrue(len(figure_files) > 0, "No figure files found in FIGURES or its subdirectories.")

        # Clean up function
        def remove_dir(dir_path):
            if os.path.exists(dir_path):
                shutil.rmtree(dir_path, ignore_errors=True)

        # Clean up created directories
        for dir_name, dir_path in paths.items():
            remove_dir(dir_path)

        # Optionally, check and remove the top-level directories if they are empty
        for dir_name in expected_dirs:
            top_level_dir = os.path.join(base_path, dir_name)
            if os.path.exists(top_level_dir) and not os.listdir(top_level_dir):
                remove_dir(top_level_dir)


if __name__ == "__main__":
    unittest.main()
